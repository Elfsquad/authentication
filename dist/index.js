var e={438:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequest=void 0;var n=o(537),r=o(96),i=function(){function e(t,o,r){void 0===o&&(o=new n.DefaultCrypto),void 0===r&&(r=!0),this.crypto=o,this.usePkce=r,this.clientId=t.client_id,this.redirectUri=t.redirect_uri,this.scope=t.scope,this.responseType=t.response_type||e.RESPONSE_TYPE_CODE,this.state=t.state||function(e){return e.generateRandom(10)}(o),this.extras=t.extras,this.internal=t.internal}return e.prototype.setupCodeVerifier=function(){var e=this;if(this.usePkce){var t=this.crypto.generateRandom(128);return this.crypto.deriveChallenge(t).catch((function(e){r.log("Unable to generate PKCE challenge. Not using PKCE",e)})).then((function(o){o&&(e.internal=e.internal||{},e.internal.code_verifier=t,e.extras=e.extras||{},e.extras.code_challenge=o,e.extras.code_challenge_method="S256")}))}return Promise.resolve()},e.prototype.toJson=function(){var e=this;return this.setupCodeVerifier().then((function(){return{response_type:e.responseType,client_id:e.clientId,redirect_uri:e.redirectUri,scope:e.scope,state:e.state,extras:e.extras,internal:e.internal}}))},e.RESPONSE_TYPE_TOKEN="token",e.RESPONSE_TYPE_CODE="code",e}();t.AuthorizationRequest=i},960:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationRequestHandler=t.BUILT_IN_PARAMETERS=t.AuthorizationNotifier=void 0;var n=o(96),r=function(){function e(){this.listener=null}return e.prototype.setAuthorizationListener=function(e){this.listener=e},e.prototype.onAuthorizationComplete=function(e,t,o){this.listener&&this.listener(e,t,o)},e}();t.AuthorizationNotifier=r,t.BUILT_IN_PARAMETERS=["redirect_uri","client_id","response_type","state","scope"];var i=function(){function e(e,t){this.utils=e,this.crypto=t,this.notifier=null}return e.prototype.buildRequestUrl=function(e,o){var n={redirect_uri:o.redirectUri,client_id:o.clientId,response_type:o.responseType,state:o.state,scope:o.scope};if(o.extras)for(var r in o.extras)o.extras.hasOwnProperty(r)&&t.BUILT_IN_PARAMETERS.indexOf(r)<0&&(n[r]=o.extras[r]);var i=this.utils.stringify(n);return e.authorizationEndpoint+"?"+i},e.prototype.completeAuthorizationRequestIfPossible=function(){var e=this;return n.log("Checking to see if there is an authorization response to be delivered."),this.notifier||n.log("Notifier is not present on AuthorizationRequest handler.\n          No delivery of result will be possible"),this.completeAuthorizationRequest().then((function(t){t||n.log("No result is available yet."),t&&e.notifier&&e.notifier.onAuthorizationComplete(t.request,t.response,t.error)}))},e.prototype.setAuthorizationNotifier=function(e){return this.notifier=e,this},e}();t.AuthorizationRequestHandler=i},208:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationError=t.AuthorizationResponse=void 0;var o=function(){function e(e){this.code=e.code,this.state=e.state}return e.prototype.toJson=function(){return{code:this.code,state:this.state}},e}();t.AuthorizationResponse=o;var n=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri,this.state=e.state}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri,state:this.state}},e}();t.AuthorizationError=n},373:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AuthorizationServiceConfiguration=void 0;var n=o(157),r=function(){function e(e){this.authorizationEndpoint=e.authorization_endpoint,this.tokenEndpoint=e.token_endpoint,this.revocationEndpoint=e.revocation_endpoint,this.userInfoEndpoint=e.userinfo_endpoint,this.endSessionEndpoint=e.end_session_endpoint}return e.prototype.toJson=function(){return{authorization_endpoint:this.authorizationEndpoint,token_endpoint:this.tokenEndpoint,revocation_endpoint:this.revocationEndpoint,end_session_endpoint:this.endSessionEndpoint,userinfo_endpoint:this.userInfoEndpoint}},e.fetchFromIssuer=function(t,o){var r=t+"/.well-known/openid-configuration";return(o||new n.JQueryRequestor).xhr({url:r,dataType:"json",method:"GET"}).then((function(t){return new e(t)}))},e}();t.AuthorizationServiceConfiguration=r},537:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultCrypto=t.textEncodeLite=t.urlSafe=t.bufferToString=void 0;var n=o(742),r=o(3),i="undefined"!=typeof window&&!!window.crypto,s=i&&!!window.crypto.subtle,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";function u(e){for(var t=[],o=0;o<e.byteLength;o+=1){var n=e[o]%a.length;t.push(a[n])}return t.join("")}function c(e){return n.fromByteArray(new Uint8Array(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function h(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),n=0;n<e.length;n++)o[n]=e.charCodeAt(n);return o}t.bufferToString=u,t.urlSafe=c,t.textEncodeLite=h;var l=function(){function e(){}return e.prototype.generateRandom=function(e){var t=new Uint8Array(e);if(i)window.crypto.getRandomValues(t);else for(var o=0;o<e;o+=1)t[o]=Math.random()*a.length|0;return u(t)},e.prototype.deriveChallenge=function(e){return e.length<43||e.length>128?Promise.reject(new r.AppAuthError("Invalid code length.")):s?new Promise((function(t,o){crypto.subtle.digest("SHA-256",h(e)).then((function(e){return t(c(new Uint8Array(e)))}),(function(e){return o(e)}))})):Promise.reject(new r.AppAuthError("window.crypto.subtle is unavailable."))},e}();t.DefaultCrypto=l},3:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppAuthError=void 0;t.AppAuthError=function(e,t){this.message=e,this.extras=t}},577:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.IS_PROFILE=t.IS_LOG=void 0,t.IS_LOG=!0,t.IS_PROFILE=!1},865:function(e,t,o){var n=this&&this.__createBinding||(Object.create?function(e,t,o,n){void 0===n&&(n=o),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[o]}})}:function(e,t,o,n){void 0===n&&(n=o),e[n]=t[o]}),r=this&&this.__exportStar||function(e,t){for(var o in e)"default"===o||Object.prototype.hasOwnProperty.call(t,o)||n(t,e,o)};Object.defineProperty(t,"__esModule",{value:!0}),r(o(438),t),r(o(960),t),r(o(208),t),r(o(373),t),r(o(537),t),r(o(3),t),r(o(577),t),r(o(96),t),r(o(629),t),r(o(417),t),r(o(33),t),r(o(480),t),r(o(892),t),r(o(551),t),r(o(298),t),r(o(53),t),r(o(157),t)},96:function(e,t,o){var n=this&&this.__spreadArray||function(e,t){for(var o=0,n=t.length,r=e.length;o<n;o++,r++)e[r]=t[o];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.profile=t.log=void 0;var r=o(577);function i(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];if(r.IS_LOG){var i=t?t.length:0;i>0?console.log.apply(console,n([e],t)):console.log(e)}}t.log=i;var s="undefined"!=typeof window&&!!window.performance&&!!console.profile;t.profile=function(e,t,o){return r.IS_PROFILE?function(e,t,o){var r=o.value,a=r.name;return a||(a="anonymous function"),o.value=s?function(e){console.profile(a);var t=window.performance.now(),o=r.call.apply(r,n([this||window],e)),i=window.performance.now()-t;return console.log(a+" took "+i+" ms"),console.profileEnd(),o}:function(e){i("Profile start "+a);var t=Date.now(),o=r.call.apply(r,n([this||window],e)),s=Date.now()-t;return i("Profile end "+a+" took "+s+" ms."),o},o}(0,0,o):o}},629:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BasicQueryStringUtils=void 0;var o=function(){function e(){}return e.prototype.parse=function(e,t){return t?this.parseQueryString(e.hash):this.parseQueryString(e.search)},e.prototype.parseQueryString=function(e){for(var t={},o=(e=e.trim().replace(/^(\?|#|&)/,"")).split("&"),n=0;n<o.length;n+=1){var r=o[n].split("=");if(r.length>=2){var i=decodeURIComponent(r.shift()),s=r.length>0?r.join("="):null;s&&(t[i]=decodeURIComponent(s))}}return t},e.prototype.stringify=function(e){var t=[];for(var o in e)e.hasOwnProperty(o)&&e[o]&&t.push(encodeURIComponent(o)+"="+encodeURIComponent(e[o]));return t.join("&")},e}();t.BasicQueryStringUtils=o},417:function(e,t,o){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.RedirectRequestHandler=void 0;var i=o(438),s=o(960),a=o(208),u=o(537),c=o(96),h=o(629),l=o(480),p=function(e){return e+"_appauth_authorization_request"},d=function(e){return e+"_appauth_authorization_service_configuration"},f="appauth_current_authorization_request",v=function(e){function t(t,o,n,r){void 0===t&&(t=new l.LocalStorageBackend),void 0===o&&(o=new h.BasicQueryStringUtils),void 0===n&&(n=window.location),void 0===r&&(r=new u.DefaultCrypto);var i=e.call(this,o,r)||this;return i.storageBackend=t,i.locationLike=n,i}return r(t,e),t.prototype.performAuthorizationRequest=function(e,t){var o=this,n=this.crypto.generateRandom(10);Promise.all([this.storageBackend.setItem(f,n),t.toJson().then((function(e){return o.storageBackend.setItem(p(n),JSON.stringify(e))})),this.storageBackend.setItem(d(n),JSON.stringify(e.toJson()))]).then((function(){var n=o.buildRequestUrl(e,t);c.log("Making a request to ",t,n),o.locationLike.assign(n)}))},t.prototype.completeAuthorizationRequest=function(){var e=this;return this.storageBackend.getItem(f).then((function(t){return t?e.storageBackend.getItem(p(t)).then((function(e){return JSON.parse(e)})).then((function(e){return new i.AuthorizationRequest(e)})).then((function(o){var n=""+e.locationLike.origin+e.locationLike.pathname,r=e.utils.parse(e.locationLike,!0),i=r.state,s=r.code,u=r.error;c.log("Potential authorization request ",n,r,i,s,u);var h=i===o.state,l=null,v=null;if(h){if(u){var _=r.error_uri,k=r.error_description;v=new a.AuthorizationError({error:u,error_description:k,error_uri:_,state:i})}else l=new a.AuthorizationResponse({code:s,state:i});return Promise.all([e.storageBackend.removeItem(f),e.storageBackend.removeItem(p(t)),e.storageBackend.removeItem(d(t))]).then((function(){return c.log("Delivering authorization response"),{request:o,response:l,error:v}}))}return c.log("Mismatched request (state and request_uri) dont match."),Promise.resolve(null)})):null}))},t}(s.AuthorizationRequestHandler);t.RedirectRequestHandler=v},33:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.RevokeTokenRequest=void 0;var o=function(){function e(e){this.token=e.token,this.tokenTypeHint=e.token_type_hint,this.clientId=e.client_id,this.clientSecret=e.client_secret}return e.prototype.toJson=function(){var e={token:this.token};return this.tokenTypeHint&&(e.token_type_hint=this.tokenTypeHint),this.clientId&&(e.client_id=this.clientId),this.clientSecret&&(e.client_secret=this.clientSecret),e},e.prototype.toStringMap=function(){return this.toJson()},e}();t.RevokeTokenRequest=o},480:function(e,t){var o,n=this&&this.__extends||(o=function(e,t){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},o(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.LocalStorageBackend=t.StorageBackend=void 0;var r=function(){};t.StorageBackend=r;var i=function(e){function t(t){var o=e.call(this)||this;return o.storage=t||window.localStorage,o}return n(t,e),t.prototype.getItem=function(e){var t=this;return new Promise((function(o,n){o(t.storage.getItem(e)||null)}))},t.prototype.removeItem=function(e){var t=this;return new Promise((function(o,n){t.storage.removeItem(e),o()}))},t.prototype.clear=function(){var e=this;return new Promise((function(t,o){e.storage.clear(),t()}))},t.prototype.setItem=function(e,t){var o=this;return new Promise((function(n,r){o.storage.setItem(e,t),n()}))},t}(r);t.LocalStorageBackend=i},892:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenRequest=t.GRANT_TYPE_REFRESH_TOKEN=t.GRANT_TYPE_AUTHORIZATION_CODE=void 0,t.GRANT_TYPE_AUTHORIZATION_CODE="authorization_code",t.GRANT_TYPE_REFRESH_TOKEN="refresh_token";var o=function(){function e(e){this.clientId=e.client_id,this.redirectUri=e.redirect_uri,this.grantType=e.grant_type,this.code=e.code,this.refreshToken=e.refresh_token,this.extras=e.extras}return e.prototype.toJson=function(){return{grant_type:this.grantType,code:this.code,refresh_token:this.refreshToken,redirect_uri:this.redirectUri,client_id:this.clientId,extras:this.extras}},e.prototype.toStringMap=function(){var e={grant_type:this.grantType,client_id:this.clientId,redirect_uri:this.redirectUri};if(this.code&&(e.code=this.code),this.refreshToken&&(e.refresh_token=this.refreshToken),this.extras)for(var t in this.extras)this.extras.hasOwnProperty(t)&&!e.hasOwnProperty(t)&&(e[t]=this.extras[t]);return e},e}();t.TokenRequest=o},551:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseTokenRequestHandler=void 0;var n=o(3),r=o(629),i=o(298),s=o(157),a=function(){function e(e,t){void 0===e&&(e=new s.JQueryRequestor),void 0===t&&(t=new r.BasicQueryStringUtils),this.requestor=e,this.utils=t}return e.prototype.isTokenResponse=function(e){return void 0===e.error},e.prototype.performRevokeTokenRequest=function(e,t){return this.requestor.xhr({url:e.revocationEndpoint,method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then((function(e){return!0}))},e.prototype.performTokenRequest=function(e,t){var o=this;return this.requestor.xhr({url:e.tokenEndpoint,method:"POST",dataType:"json",headers:{"Content-Type":"application/x-www-form-urlencoded"},data:this.utils.stringify(t.toStringMap())}).then((function(e){return o.isTokenResponse(e)?new i.TokenResponse(e):Promise.reject(new n.AppAuthError(e.error,new i.TokenError(e)))}))},e}();t.BaseTokenRequestHandler=a},298:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenError=t.TokenResponse=t.nowInSeconds=void 0,t.nowInSeconds=function(){return Math.round((new Date).getTime()/1e3)};var o=function(){function e(e){this.accessToken=e.access_token,this.tokenType=e.token_type||"bearer",e.expires_in&&(this.expiresIn=parseInt(e.expires_in,10)),this.refreshToken=e.refresh_token,this.scope=e.scope,this.idToken=e.id_token,this.issuedAt=e.issued_at||t.nowInSeconds()}return e.prototype.toJson=function(){var e;return{access_token:this.accessToken,id_token:this.idToken,refresh_token:this.refreshToken,scope:this.scope,token_type:this.tokenType,issued_at:this.issuedAt,expires_in:null===(e=this.expiresIn)||void 0===e?void 0:e.toString()}},e.prototype.isValid=function(e){return void 0===e&&(e=-600),!this.expiresIn||t.nowInSeconds()<this.issuedAt+this.expiresIn+e},e}();t.TokenResponse=o;var n=function(){function e(e){this.error=e.error,this.errorDescription=e.error_description,this.errorUri=e.error_uri}return e.prototype.toJson=function(){return{error:this.error,error_description:this.errorDescription,error_uri:this.errorUri}},e}();t.TokenError=n},53:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0})},157:function(e,t,o){var n,r=this&&this.__extends||(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)});Object.defineProperty(t,"__esModule",{value:!0}),t.TestRequestor=t.FetchRequestor=t.JQueryRequestor=t.Requestor=void 0;var i=o(3),s=function(){};t.Requestor=s;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.xhr=function(e){var t=$.ajax(e);return new Promise((function(e,o){t.then((function(t,o,n){e(t)}),(function(e,t,n){o(new i.AppAuthError(n))}))}))},t}(s);t.JQueryRequestor=a;var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.xhr=function(e){if(!e.url)return Promise.reject(new i.AppAuthError("A URL must be provided."));var t=new URL(e.url),o={};if(o.method=e.method,o.mode="cors",e.data&&(e.method&&"POST"===e.method.toUpperCase()?o.body=e.data:new URLSearchParams(e.data).forEach((function(e,o){t.searchParams.append(o,e)}))),o.headers={},e.headers)for(var n in e.headers)e.headers.hasOwnProperty(n)&&(o.headers[n]=e.headers[n]);var r=e.dataType&&"json"===e.dataType.toLowerCase();return r&&(o.headers.Accept="application/json, text/javascript, */*; q=0.01"),fetch(t.toString(),o).then((function(e){if(e.status>=200&&e.status<300){var t=e.headers.get("content-type");return r||t&&-1!==t.indexOf("application/json")?e.json():e.text()}return Promise.reject(new i.AppAuthError(e.status.toString(),e.statusText))}))},t}(s);t.FetchRequestor=u;var c=function(e){function t(t){var o=e.call(this)||this;return o.promise=t,o}return r(t,e),t.prototype.xhr=function(e){return this.promise},t}(s);t.TestRequestor=c},742:(e,t)=>{t.byteLength=function(e){var t=u(e),o=t[0],n=t[1];return 3*(o+n)/4-n},t.toByteArray=function(e){var t,o,i=u(e),s=i[0],a=i[1],c=new r(function(e,t,o){return 3*(t+o)/4-o}(0,s,a)),h=0,l=a>0?s-4:s;for(o=0;o<l;o+=4)t=n[e.charCodeAt(o)]<<18|n[e.charCodeAt(o+1)]<<12|n[e.charCodeAt(o+2)]<<6|n[e.charCodeAt(o+3)],c[h++]=t>>16&255,c[h++]=t>>8&255,c[h++]=255&t;return 2===a&&(t=n[e.charCodeAt(o)]<<2|n[e.charCodeAt(o+1)]>>4,c[h++]=255&t),1===a&&(t=n[e.charCodeAt(o)]<<10|n[e.charCodeAt(o+1)]<<4|n[e.charCodeAt(o+2)]>>2,c[h++]=t>>8&255,c[h++]=255&t),c},t.fromByteArray=function(e){for(var t,n=e.length,r=n%3,i=[],s=16383,a=0,u=n-r;a<u;a+=s)i.push(c(e,a,a+s>u?u:a+s));return 1===r?(t=e[n-1],i.push(o[t>>2]+o[t<<4&63]+"==")):2===r&&(t=(e[n-2]<<8)+e[n-1],i.push(o[t>>10]+o[t>>4&63]+o[t<<2&63]+"=")),i.join("")};for(var o=[],n=[],r="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,a=i.length;s<a;++s)o[s]=i[s],n[i.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var o=e.indexOf("=");return-1===o&&(o=t),[o,o===t?0:4-o%4]}function c(e,t,n){for(var r,i,s=[],a=t;a<n;a+=3)r=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),s.push(o[(i=r)>>18&63]+o[i>>12&63]+o[i>>6&63]+o[63&i]);return s.join("")}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},202:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(s,a)}u((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.AuthenticationContext=void 0;const r=o(373),i=o(438),s=o(417),a=o(892),u=o(865),c=o(514);class h{constructor(){this.requestor=new u.FetchRequestor}xhr(e){return e.xhrFields.withCredentials=!0,this.requestor.xhr(e)}}t.AuthenticationContext=class{constructor(e){this.options=e,this.loginUrl="https://login.elfsquad.io",this.onSignInResolvers=[],this.onSignInRejectors=[],this.signedInResolvers=[],this.isInitialized=!1,this._refreshTokenPromise=null,e?e.clientId?e.redirectUri?(e.scope||(e.scope="Elfskot.Api offline_access"),e.loginUrl&&(this.loginUrl=e.loginUrl),this.fetchRequestor=new h,this.tokenHandler=new u.BaseTokenRequestHandler(this.fetchRequestor),this.authorizationHandler=new l,this.initialize()):console.error("No redirect uri provided"):console.error("No client id provided"):console.error("No authentication options were provided")}onSignIn(){return this.validateAccessTokenResponse()?Promise.resolve():new Promise(((e,t)=>{this.onSignInResolvers.push(e),this.onSignInRejectors.push(t)}))}signIn(){return n(this,void 0,void 0,(function*(){yield this.fetchConfiguration(),this.makeAuthorizationRequest()}))}signOut(){this.revokeTokens().then((e=>{this.deleteTokens(),this.endSession()}))}deleteTokens(){this.accessTokenResponse=null,c.TokenStore.deleteRefreshToken(),c.TokenStore.deleteTokenResponse()}revokeTokens(){return c.TokenStore.hasRefreshToken()&&this.revokeToken(c.TokenStore.getRefreshToken(),"refresh_token"),c.TokenStore.hasTokenResponse()&&this.revokeToken(c.TokenStore.getTokenResponse().accessToken,"access_token"),Promise.all([null,null])}revokeToken(e,t){return n(this,void 0,void 0,(function*(){const o=new u.RevokeTokenRequest({token:e,token_type_hint:t,client_id:this.options.clientId}),n=yield this.tokenHandler.performRevokeTokenRequest(this.configuration,o);console.log(t,n),n||console.error(`Revoke token request for token '${t}' failed`)}))}endSession(){window.location.href=this.configuration.endSessionEndpoint}isSignedIn(){return new Promise(((e,t)=>{this.isInitialized?e(this.validateAccessTokenResponse()):this.signedInResolvers.push(e)}))}getAccessToken(){return n(this,void 0,void 0,(function*(){if(!this.configuration)return null;if(this.validateAccessTokenResponse())return Promise.resolve(this.accessTokenResponse.accessToken);if(!c.TokenStore.hasRefreshToken())return Promise.reject("Missing refreshToken.");if(this._refreshTokenPromise)return this._refreshTokenPromise;this._refreshTokenPromise=this.refreshAccessToken();let e=yield this._refreshTokenPromise;return this._refreshTokenPromise=null,e}))}getIdToken(){return n(this,void 0,void 0,(function*(){return this.configuration?this.validateAccessTokenResponse()?Promise.resolve(this.accessTokenResponse.idToken):c.TokenStore.hasRefreshToken()?(yield this.refreshAccessToken(),Promise.resolve(this.accessTokenResponse.idToken)):Promise.reject("Missing refreshToken."):Promise.reject("Unknown service configuration")}))}validateAccessTokenResponse(){return!!this.accessTokenResponse&&this.accessTokenResponse.isValid()}refreshAccessToken(){return n(this,void 0,void 0,(function*(){const e=new a.TokenRequest({client_id:this.options.clientId,redirect_uri:this.options.redirectUri,grant_type:a.GRANT_TYPE_REFRESH_TOKEN,code:void 0,refresh_token:c.TokenStore.getRefreshToken(),extras:void 0}),t=yield this.tokenHandler.performTokenRequest(this.configuration,e);return this.accessTokenResponse=t,c.TokenStore.saveRefreshToken(t.refreshToken),c.TokenStore.saveTokenResponse(t),t.accessToken}))}fetchConfiguration(){return n(this,void 0,void 0,(function*(){this.configuration||(this.configuration=yield r.AuthorizationServiceConfiguration.fetchFromIssuer(this.loginUrl,this.fetchRequestor))}))}makeAuthorizationRequest(){const e=new i.AuthorizationRequest({client_id:this.options.clientId,redirect_uri:this.options.redirectUri,scope:this.options.scope,response_type:i.AuthorizationRequest.RESPONSE_TYPE_CODE,state:void 0,extras:{access_type:"offline",response_mode:"fragment"}});this.authorizationHandler.performAuthorizationRequest(this.configuration,e)}onAuthorization(e,t,o){var r;return n(this,void 0,void 0,(function*(){if(location.hash="",o){for(let e of this.onSignInRejectors)e(o);return}if(!t)return;let n=new a.TokenRequest({client_id:this.options.clientId,redirect_uri:this.options.redirectUri,grant_type:a.GRANT_TYPE_AUTHORIZATION_CODE,code:t.code,refresh_token:void 0});(null===(r=e.internal)||void 0===r?void 0:r.code_verifier)&&(n.extras={code_verifier:e.internal.code_verifier}),this.configuration||(yield this.fetchConfiguration()),this.accessTokenResponse=yield this.tokenHandler.performTokenRequest(this.configuration,n),c.TokenStore.saveRefreshToken(this.accessTokenResponse.refreshToken),c.TokenStore.saveTokenResponse(this.accessTokenResponse),this.callOnSigInResolvers()}))}initialize(){return n(this,void 0,void 0,(function*(){return yield this.fetchConfiguration(),c.TokenStore.hasTokenResponse()&&(this.accessTokenResponse=c.TokenStore.getTokenResponse()),this.validateAccessTokenResponse()?(this.isInitialized=!0,this.callOnSigInResolvers(),void this.callSignedInResolvers()):c.TokenStore.hasRefreshToken()?(yield this.fetchConfiguration(),void this.refreshAccessToken().then((()=>{this.callOnSigInResolvers()})).catch((e=>{console.error("Failed to refresh access token",e),this.deleteTokens()})).finally((()=>{this.isInitialized=!0,this.callSignedInResolvers()}))):void this.completeAuthorizationRequest()}))}completeAuthorizationRequest(){this.authorizationHandler.completeAuthorizationRequest().then((e=>n(this,void 0,void 0,(function*(){this.isInitialized=!0,e&&(yield this.onAuthorization(e.request,e.response,e.error)),this.callSignedInResolvers()}))))}callSignedInResolvers(){for(let e of this.signedInResolvers)e(this.validateAccessTokenResponse())}callOnSigInResolvers(){for(let e of this.onSignInResolvers)e()}};class l extends s.RedirectRequestHandler{completeAuthorizationRequest(){return super.completeAuthorizationRequest()}}},514:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TokenStore=void 0;const n=o(865);class r{static hasRefreshToken(){return!!localStorage.getItem(this.REFRESH_TOKEN_KEY)}static getRefreshToken(){return localStorage.getItem(this.REFRESH_TOKEN_KEY)}static saveRefreshToken(e){localStorage.setItem(this.REFRESH_TOKEN_KEY,e)}static deleteRefreshToken(){localStorage.removeItem(this.REFRESH_TOKEN_KEY)}static hasTokenResponse(){return!!localStorage.getItem("elfsquad_token_response")}static getTokenResponse(){const e=localStorage.getItem("elfsquad_token_response"),t=JSON.parse(e);return new n.TokenResponse(t)}static deleteTokenResponse(){localStorage.removeItem("elfsquad_token_response")}static saveTokenResponse(e){const t=JSON.stringify(e.toJson());localStorage.setItem("elfsquad_token_response",t)}}t.TokenStore=r,r.REFRESH_TOKEN_KEY="elfsquad_refresh_token"}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}var n={};(()=>{var e=n;Object.defineProperty(e,"X",{value:!0}),e.z=void 0;var t=o(202);Object.defineProperty(e,"z",{enumerable:!0,get:function(){return t.AuthenticationContext}})})();var r=n.z,i=n.X;export{r as AuthenticationContext,i as __esModule};